<?xml version="1.0" encoding="UTF-8"?>
<Queries>
<SelectQuery id="whoami" operation="select email as name, role_name from v_emp_roles where email=?">
<OperationParams>
<Param name="ecuser" value="Guest"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="canedit" operation="select * from contact C inner join userinfo U on ( email =? and cid=userid) inner join jsearch J on (userinfojsid=jsid)">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="caneditadmin" baseQuery="canedit" >
<OperationParams>
<Param name="email"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="edit" operation="select * from contact C inner join emp E on ( email =? and cid=empid)">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="editadmin" baseQuery="edit">
<OperationParams>
<Param name="email"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="companysearch" operation="select CC.*,CO.*, E.empid, concat(CE.first_name,' ',ifnull(CE.last_name,' ')) as handler from company CO inner join   contact CC on (CC.cid=CO.compconid) left join emp E on (E.empid=CO.atte1) left join contact CE on (E.empid=CE.cid)"/>
<SelectQuery id="companyinfo" baseQuery="companysearch" operation=" where compconid=?">
<OperationParams>
<Param name="compconid"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="companylist" baseQuery="companysearch" operation=" order by compconid desc"/>
<SelectQuery id="opencomplist" baseQuery="companysearch" operation="where CO.atte1 is null order by compconid desc"/>
<SelectQuery id="empcomplist" baseQuery="companysearch" operation="where CE.email=? order by compconid desc">
<OperationParams>
<Param name="email"></Param>
</OperationParams>
</SelectQuery>
    
<SelectQuery id="companycid" operation="select cid,first_name  from contact c inner join company CO on (cid=compconid)"/>

<SelectQuery id="canmindsetinit" operation="select userid,first_name,email,js_status,js_remarks from userinfo U inner join contact C on (C.email=? and U.userid=C.cid) inner join jsearch J on (jsid=userinfojsid)">
<OperationParams>
<Param name="email"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="vacancyinfo" operation="select * from vacancy where vid=?">
<OperationParams>
<Param name="vid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="ivacancyinfo" operation="select vid as ivvacancyid,vaddress as venue from vacancy where vid=?">
<OperationParams>
<Param name="vid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="vacancysearch" operation="select v.*, case when vgender=0 then 'Any' when vgender=1 then 'Male' when vgender=2 then 'Female' end as gendervalue ,c.first_name from vacancy v inner join contact c on (v.vconid=c.cid)"/>

<SelectQuery id="vacancylist" baseQuery="vacancysearch" operation=" order by vid desc"/>
 
<SelectQuery id="canvacancy" operation="select vid,case when vgender=0 then 'Any' when vgender=1 then 'Male' when vgender=2 then 'Female' end as gender,min_age,max_age,vqual, min_exp, max_exp,vlocation,min_sal, max_sal,vsector,vdept,  skills,desg,  vcount,  jd from vacancy where end_date>=now() and vstatus='In progress' order by vid desc" />

<SelectQuery id="canapplicationbase" operation="select applied_date,vlocation,min_sal,max_sal, min_age,max_age,min_exp,max_exp, vqual from application A left join contact U on (U.cid=A.appcid)  left join vacancy V on (A.appvid=V.vid)"/>

<SelectQuery id="canapplications" baseQuery="canapplicationbase" operation=" where email=?">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="cansearch" baseQuery="canapplicationbase" operation=" where email=${ecuser}"/>

<SelectQuery id="usersearch" operation="select  U.userid, C.email, C.first_name, C.created_date, C.mobile, C.ref_mobile, U.gender, U.maxqual, U.exp, U.field,U.department,U.specialization,U.resext ,U.branch,concat (E.first_name,' ' ,ifnull(E.last_name,' ')) as handler,case when dob is not null then DATEDIFF(CURRENT_DATE, dob)/365 else exp+20 end AS age,J.pctc,J.js_status,proof_verified,C.email_uuid from userinfo U inner join jsearch J on (U.userinfojsid=J.jsid)  inner join contact C on (cid=userid) left join contact E on (J.atte1=E.cid)"/>
<SelectQuery id="userlist" baseQuery="usersearch" operation=" order by userid desc"/>
<SelectQuery id="pendinguserlist" baseQuery="usersearch" operation=" where C.email_uuid is not null order by userid desc"/>
<SelectQuery id="candlist" baseQuery="usersearch"  operation=" where E.email=? order by U.userid desc">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>


<SelectQuery id="empcandlist" baseQuery="usersearch"  operation=" where E.email=? order by U.userid desc">
<OperationParams>
<Param name="email"></Param>
</OperationParams>
</SelectQuery>


<SelectQuery id="opencandlist" baseQuery="usersearch"  operation=" where J.atte1 is null order by U.userid desc"/>

<SelectQuery id="empsearch" operation="select * from contact C inner join emp E on (cid=empid) "/>
<SelectQuery id="emplist" baseQuery="empsearch" operation=" order by first_name "/>
<SelectQuery id="employeeeid" operation="select empid,concat(first_name,', ',last_name) as ename from emp inner join contact C on (cid=empid) where status='active'"/>


<SelectQuery id="allappssearch" operation="select A.aid,V.vid,A.appcid as userid,V.vconid as compconid,V.created_date as vacancy_date,  A.applied_date, C.first_name as cname,case when V.vgender=0 then 'Any' when V.vgender=1 then 'Male' when V.vgender=2 then 'Female' end as gender,V.vlocation,vcontact_mobile,V.jd,V.desg,V.vqual,V.vsector,V.vdept,U.first_name,U.email,U.mobile,U.ref_mobile from application A left join contact U on (U.cid=A.appcid)  left join vacancy V on (A.appvid=V.vid) left join contact C on (C.cid=V.vconid) "/>

<SelectQuery id="allapps" baseQuery="allappssearch" operation=" order by A.aid desc"/>


<SelectQuery id="companyapps" baseQuery="allappssearch" operation=" where V.vconid =? order by A.aid desc">
<OperationParams>
<Param name="compconid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="vacancyapps" baseQuery="allappssearch" operation=" where A.appvid=?  order by A.aid desc">
<OperationParams>
<Param name="vid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="canapps" baseQuery="allappssearch" operation=" where A.appcid=?">
<OperationParams>
<Param name="userid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="paymentsearch" operation=" select pid,paymentconid,paid_date, ptype,bank_ref_no,amount,init_remark, u.cid as userid,first_name,email,mobile,order_status,save_type  from payments p left join contact u on (u.cid=p.paymentconid) "/>

<SelectQuery id="paymentlist" baseQuery="paymentsearch" operation=" order by p.pid desc"/>
<SelectQuery id="paymentinfo" baseQuery="paymentsearch" operation=" where pid=?">
<OperationParams>
<Param name="pid"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="fetchuserpay" operation="select cid as userid,email,first_name, last_name, topay,scharge,rscharge,js_status from contact C inner join jsearch J on (J.jsearchuserid=C.cid) where email=?">
<OperationParams>
<Param name="email"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="userpay" baseQuery="fetchuserpay">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="fetchuserrole" operation="select V.email as user, first_name, last_name,role_name from v_user_roles V inner join contact C on (V.lid=C.cid) where lid=?">
<OperationParams>
<Param name="userid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="snapshotsearch" operation="select userid, gender,case when dob is not null then DATEDIFF(CURRENT_DATE, dob)/365 else exp+20 end AS age, maxqual,exp,pref_location,pctc,field,department,specialization, ectc, machines_handled,gauges_handled, products_handled,num_products,customers_handled,team_size_handled,training,mgmt_sys_handled,cert_handled,achieve,contributions,known_lang,js_status   from userinfo U inner join jsearch J on (J.jsid= U.userinfojsid) " />

<SelectQuery id="snapshot" baseQuery="snapshotsearch" operation=" order by js_status  ,userid desc "/>

<SelectQuery id="snapshotweb" baseQuery="snapshotsearch" operation=" where js_status in ('Registered','Paid','Attend','Placed','Boosted') order by rscharge desc, boost_amount desc, ectc desc"/>

<SelectQuery id="resreqbase" operation="select R.*,concat (E.first_name,' ' ,ifnull(E.last_name,' ')) as recruiter, concat (C.first_name,' ' ,ifnull(C.last_name,' ')) as candidate,E.email as rec_email, C.email as can_email  from rec_can_request R inner join contact C on (R.canid=C.cid) inner join contact E on (R.recid=E.cid) where R.status = 'open'"/>
<SelectQuery id="resreq" baseQuery="resreqbase" operation=" order by R.created_date desc" />

<SelectQuery id="resreqedit" baseQuery="resreqbase" operation=" and recid=? and canid=? " >
<OperationParams>
<Param name="recid"></Param>
<Param name="canid"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="ref_count" operation=" select count(*) as ref_count from contact R inner join contact U  on R.email=? and R.mobile=U.ref_mobile">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>
<SelectQuery id="earnings" operation="select R.cid as empid, R.mobile, ifnull(sum(case when datediff(now(),paid_date)=0 then amount end ),0) as total_today, ifnull(sum(case when datediff(now(),paid_date)&lt;7 then amount end ),0) as total_week, ifnull(sum(case when datediff(now(),paid_date)&lt;30 then amount end ),0) as total_30, ifnull(sum(case when datediff(now(),paid_date)&lt;365 then amount end ),0) as total_365, ifnull(sum(amount),0) as total_all,  ifnull(sum(case when paid_date>(concat(extract(YEAR from now()),'-',extract(MONTH from now()),'-01')) then amount end ),0) as total_month, ifnull(sum(case when paid_date>(concat(extract(YEAR from now()),'-01-01')) then amount end ),0) as total_year from contact R inner join contact U on R.email=? and R.mobile=U.ref_mobile  inner join payments P on  U.cid=P.paymentconid and P.order_status='Success'  group by R.cid,R.mobile">
<OperationParams>
<Param name="ecuser"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="ivcansel" operation="select cid, concat(cid,' ',email,' ',first_name,' ',ifnull(last_name,' ')) as disp from contact C inner join userinfo U on (cid=userid)  inner join jsearch J on (J.jsid=U.userinfojsid) where js_status in ('Paid','Attend','Placed')" />

<SelectQuery id="ivsearch" operation="select I.*,U.email, U.cid as userid,U.first_name,U.last_name, C.first_name as cname,V.desg  from iv I inner join contact U on (I.ivconid=U.cid) inner join vacancy V on (V.vid=I.ivvacancyid) inner join contact C on (C.cid=V.vconid)" />

<SelectQuery id="ivlist" baseQuery="ivsearch" operation="order by ivid desc" />

<SelectQuery id="ivinfo" baseQuery="ivsearch" operation="where ivid=?" >
<OperationParams>
<Param name="ivid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="refundsearch" operation="select U.first_name,U.last_name ,U.email, R.* from refund R inner join contact U on (R.refundconid=U.cid) "/>

<SelectQuery id="refundlist" baseQuery="refundsearch" operation="order by rid desc" />

<SelectQuery id="refundinfo" baseQuery="refundsearch" operation="where rid=?" >
<OperationParams>
<Param name="rid"></Param>
</OperationParams>
</SelectQuery>

<SelectQuery id="contactsearch" operation="select * from contact"/>

<SelectQuery id="contactlist" baseQuery="contactsearch" operation="order by cid desc" />

<SelectQuery id="contactinfo" baseQuery="contactsearch" operation="where cid=?" >
<OperationParams>
<Param name="cid"></Param>
</OperationParams>
</SelectQuery>

</Queries>


